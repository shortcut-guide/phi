---
import PaymentMethodList from "@/f/components/PaymentMethodList.astro";

const lang = "ja";
const res = await fetch("/api/payment");
const { selectedMethod } = await res.json();

async function save() {
  const selected = document.querySelector("input[name=payment]:checked")?.value;
  if (selected) {
    await fetch("/api/payment", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ method: selected })
    });
    alert("設定を保存しました");
  }
}
---

<h1 class="text-xl font-bold mb-4">{messages.payment[lang].title}</h1>

<PaymentMethodList selectedMethod={selectedMethod} lang={lang} />

<div class="mt-8">
  <button class="bg-red-500 text-white px-4 py-2 rounded w-full" onClick={save}>
    {messages.payment[lang].setButton}
  </button>
</div>
